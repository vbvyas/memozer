extends layout

block content
  h2 #{contact.name}
  div.row
    div.col-md-1.col-xs-2
      img(src='#{contact.profileImageUrl}')
    div.col-md-9.col-xs-5.text-left
      a.btn.btn-primary(href='http://twitter.com/#{contact.twitterUsername}', target='_BLANK')         
        strong #{contact.twitterUsername} &nbsp;
        span.fa.fa-twitter
    div.col-md-1.col-xs-2
      a.btn.btn-primary(href='/followups/contacts/#{contact.twitterUsername}') 
        span.glyphicon.glyphicon-list
    div.col-md-1.col-xs-2
      a.btn.btn-primary(href='/contacts/#{contact.twitterUsername}/edit') 
        span.glyphicon.glyphicon-edit     
  hr 
  if(contact.memo)
    p!=  contact.memo.replace(/</g, "&lt;").replace(/>/g, '&gt;').replace(/\n/g, '<br />')
  else
    p You have no notes on this person
  hr           
  div
    if(contact.tags)
      each tag in contact.tags.split(',')
        span.label.label-info #{tag}
        | &nbsp;
      br
  if(contact.connectionLocation.name)
    p.text-info Met @ #{contact.connectionLocation.name}
  p.text-primary Added #{ago}

  hr
  
  .text-center
    a.btn.btn-info.my-btn(
      href="https://twitter.com/intent/tweet?text=#{tweet}&via=memozerapp&url=http%3A%2F%2Fwww.memozer.com")
        span.fa.fa-twitter
        span(style="padding-left: 0.5em") Tweet @#{contact.twitterUsername}

  br
  form.text-center.form-inline.confirm(action="/followups/new", method="get")
    input(type='hidden', name='contact_username', value="#{contact.twitterUsername}")
    input(type='hidden', name='contact_name', value="#{contact.name}")
    input(type='hidden', name='contact_profile_image_url', value="#{contact.profileImageUrl}")
    button.btn.btn-primary.my-btn(type="submit")      
      span.glyphicon.glyphicon-list &nbsp;
      | Follow-up &nbsp;
      span.glyphicon.glyphicon-plus  
  br
  - var action = '/contacts/' + contact.twitterUsername
  form.text-center.form-inline.confirm(action=action, method="post")
    input(type='hidden', name='_csrf', value="#{csrf_token}")
    input(type="hidden", name="_method", value="DELETE")
    button.btn.btn-danger.my-btn(type="submit") Delete Contact
  br      
  
  ul.pager
    li.previous 
      a(href="/contacts") &larr; &nbsp; Back to Contacts &nbsp;
        span.fa.fa-users 

  script.
    mixpanel.track("contact");
    // Makes all buttons to have the max width
    $('.my-btn').width(
      Math.max.apply( 
        Math, 
        $('.my-btn').map(function(){
          return $(this).outerWidth();
        }).get()
      )
    );
    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
